#!/bin/env python3
from psycopg2 import connect, DatabaseError
from os import environ
from time import sleep
from sys import argv, path, exit

env = environ.get

path.append(env("GAME")) # my_whatever/game_docker
from sql.sql_query import psql

summon_cost = 10


def conn():
    conn = None
    
    try:
        connection = connect(host=str(env("POSTGRES_HOST")), 
                            database=str(env("POSTGRES_DB")), 
                            user=str(env("POSTGRES_USER")), 
                            password=str(env("POSTGRES_PASSWORD")))
        
        sql = psql(connection)
        get, update, insert = sql.get_value, sql.update_value, sql.insert_new
        
        inventory = get(table="items") # get(table=[argv[1] if len(argv) > 1 else 'items'][0])
            
        worker = insert(table="worker", row="race", race_name=f"Human")
        [print(f"{n}: {worker[n]}") for n in worker]
        
    except (Exception, DatabaseError) as error:
        print(error)
    finally:
        if conn is not None:
            conn.close()
            print('Database connection closed.')
    
    
    
def check_available_resources(inv, vars) -> bool:
    cost = summon_cost * int(vars[1]) if len(vars[1]) > 1 else 1
    
    energy = inv["Energy rock"]
    if energy >= cost:
        return True
    return False
    
    
def argv_test() -> int:
    if len(argv) > 1:
        try:
            num = int(argv[1])
            return num
        except ValueError:
            print("Input is not a number")
            
        
    
    
if __name__ == "__main__":
    conn()
    